<!DOCTYPE html>
<html>
<head>
    <title>Blood Sugar Tracker</title>
</head>
<body>
    <h1>Welcome, {{ session.username }}!</h1>
    <p><a href="{{ url_for('logout') }}">Logout</a></p>

    <h2>Log a New Reading</h2>
    <form method="POST">
        Date: <input type="date" name="date" required><br>
        Time: <input type="time" name="time" required><br>
        Reading: <input type="number" step="0.1" name="reading" required>
        <select name="unit">
            <option value="mmol">mmol/L</option>
            <option value="mgdl">mg/dL</option>
        </select><br>
        Time of Day:
        <label for="time_of_day">Time of Day:</label>
<select name="time_of_day" id="time_of_day" required>
    <option value="First wake-up">First wake-up</option>
    <option value="Before meal">Before meal</option>
    <option value="After meal">After meal</option>
    <option value="2 hours after meal">2 hours after meal</option>
    <option value="At bedtime">At bedtime</option>
</select><br>
        <input type="submit" value="Submit">
    </form>

    {% if entries %}
        <h2>Your Previous Entries</h2>
        <table border="1">
            <tr>
                <th>Date</th><th>Time</th><th>mmol/L</th><th>mg/dL</th><th>Time of Day</th><th>Category</th>
            </tr>
            {% for entry in entries %}
            <tr>
                <td>{{ entry[0] }}</td>
                <td>{{ entry[1] }}</td>
                <td>{{ entry[2] }}</td>
                <td>{{ entry[3] }}</td>
                <td>{{ entry[4] }}</td>
                <td>{{ entry[5] }}</td>
            </tr>
            {% endfor %}
        </table>

        <h3>Average & HbA1c</h3>
        <p>Average mg/dL: {{ avg_mgdl }}</p>
        <p>HbA1c (DCCT): {{ hba1c_dcct }}%</p>
        <p>HbA1c (IFCC): {{ hba1c_ifcc }} mmol/mol</p>
    {% else %}
        <p>No entries yet.</p>
    {% endif %}
</body>
</html>
